# Backend Improvement Tasks

- [x] Make DEBUG configurable via environment variable to ease local development and production configuration.
- [x] Add additional security headers (e.g., Content-Security-Policy, Strict-Transport-Security) in custom middleware for better hardening.
- [x] Optimize product list endpoint by reducing verbose logging and adding caching to the list query.
- [x] Standardize MongoDB connection environment variables between settings and connection helper.
- [x] Trigger asynchronous order confirmation emails after order creation using Celery.
- [x] Introduce rate limiting on the login endpoint to mitigate brute-force attacks.

- [x] Add unit tests for `SecurityHeadersMiddleware` to verify required HTTP headers are present.
- [x] Refactor order creation logic into a service layer to reduce complexity and ensure atomic inventory updates.
- [x] Implement structured logging with configurable log levels and forward logs to external monitoring.
- [x] Enforce code linting (e.g., flake8/black) and integrate checks into the CI pipeline.
- [x] Require email verification for new user signups and send verification emails asynchronously.
- [x] Provide a `/health/` endpoint for basic application and database connectivity checks.
- [x] Replace stubbed `Discount` and `Category` classes in the discounts API with real model integration and remove temporary placeholders.
- [x] Implement unit tests for the discounts app covering models and API endpoints.
- [x] Generate API documentation (e.g., OpenAPI/Swagger) for easier client integration.
- [x] Serve a minimal `robots.txt` for basic SEO directives.
- [x] Add Django `AUTH_PASSWORD_VALIDATORS` to enforce strong password rules.
- [x] Replace `TokenAuthentication` with `JWTAuthentication` in order and review viewsets.
- [x] Introduce pagination to the review list endpoint to prevent unbounded result sets.
- [x] Apply rate throttling to review creation to mitigate spam submissions.
- [x] Move review rating and count updates into model methods or a service layer.
- [x] Add tests covering review creation, update, and deletion with rating recalculation.
- [x] Allow client-defined page size with an upper bound in `CustomProductPagination`.
- [x] Restrict product creation, update, and deletion endpoints to staff users.
- [x] Add a unique `slug` field to `Product` for SEO-friendly URLs.
- [x] Support filtering products by category and price range using query parameters.
- [x] Write tests verifying caching behavior for product list and detail views.
- [x] Release reserved inventory when orders are canceled or payments fail.
- [ ] Add unit tests for `create_order_from_cart` covering discounts and inventory changes.
- [ ] Implement an order cancellation endpoint that restores inventory.
- [ ] Schedule a periodic Celery task to purge inactive carts.
- [ ] Provide a management command to remove expired email verification tokens.
- [ ] Integrate Bandit security scanning into the CI workflow.
- [ ] Add a `pre-commit` configuration to enforce formatting and linting before commits.
- [ ] Introduce static type checking with mypy and add type hints across the codebase.
- [ ] Replace string `user_id` fields in Mongo documents with `ReferenceField` to the `User` model.
- [ ] Cache category list responses and invalidate cache on updates.
- [ ] Internationalize user-facing error messages via Django's translation framework.
- [ ] Document authentication requirements and examples in the README.
- [ ] Normalize discount codes to enforce case-insensitive uniqueness.
- [ ] Log unhandled Stripe webhook event types for easier debugging.
